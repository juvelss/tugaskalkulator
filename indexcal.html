<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Keren</title>
    <!-- Menggunakan Bootstrap untuk styling dan layout yang rapih -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Lato dari Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Menggunakan font Lato */
        body {
            font-family: 'Lato', sans-serif;
        }
        /* Efek klik tombol yang lebih baik */
        .btn-calc {
            transition: all 0.1s ease-in-out;
        }
        .btn-calc:active {
            transform: scale(0.95);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        /* Warna kustom: baby blue, light purple, light pink */
        .bg-baby-blue { background-color: #89CFF0; }
        .bg-light-purple { background-color: #CBC3E3; }
        .bg-light-pink { background-color: #FFB6C1; }
        .text-baby-blue { color: #89CFF0; }
        .text-light-purple { color: #CBC3E3; }
        .text-light-pink { color: #FFB6C1; }
        .border-baby-blue { border-color: #89CFF0; }
        .border-light-purple { border-color: #CBC3E3; }
        .border-light-pink { border-color: #FFB6C1; }
    </style>
</head>
<body class="bg-light-purple text-dark min-vh-100 d-flex align-items-center justify-content-center p-4">

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6 col-lg-4">
                <div class="card bg-light-pink shadow-lg rounded-3 p-4">
                    <div class="card-body">
                        <!-- Gambar status kalkulator yang menampilkan kondisi perhitungan -->
                        <div class="mb-3">
                            <img id="statusImage" 
                                 src="https://placehold.co/400x100/CBC3E3/FFFFFF?text=Kalkulator" 
                                 alt="Status Kalkulator"
                                 class="img-fluid rounded shadow-sm">
                        </div>

                        <!-- Input display untuk menampilkan angka dan hasil perhitungan -->
                        <div class="bg-baby-blue rounded p-3 mb-3 shadow-sm">
                            <input type="text" id="display" 
                                   class="form-control bg-transparent text-end fs-1 font-monospace text-dark border-0 outline-none p-2" 
                                   readonly 
                                   placeholder="0">
                        </div>

                        <!-- Nama dan NIM wajib ditampilkan di kalkulator -->
                        <div class="text-center mb-3">
                            <p class="mb-0 fw-bold">Juvelin Langi - 1710624007</p>
                        </div>

                        <!-- Grid tombol kalkulator menggunakan Bootstrap grid -->
                        <div class="row g-2">
                            <!-- Baris pertama tombol: C, DEL, %, / -->
                            <div class="col-3">
                                <button data-value="C" class="btn btn-danger btn-calc w-100 py-3 fs-4 fw-bold">C</button>
                            </div>
                            <div class="col-3">
                                <button data-value="DEL" class="btn btn-secondary btn-calc w-100 py-3 fs-4 fw-bold">DEL</button>
                            </div>
                            <div class="col-3">
                                <button data-value="%" class="btn btn-secondary btn-calc w-100 py-3 fs-4 fw-bold">%</button>
                            </div>
                            <div class="col-3">
                                <button data-value="/" class="btn btn-primary btn-calc w-100 py-3 fs-4 fw-bold">/</button>
                            </div>

                            <!-- Baris kedua tombol: 7, 8, 9, * -->
                            <div class="col-3">
                                <button data-value="7" class="btn btn-dark btn-calc w-100 py-3 fs-4 fw-bold">7</button>
                            </div>
                            <div class="col-3">
                                <button data-value="8" class="btn btn-dark btn-calc w-100 py-3 fs-4 fw-bold">8</button>
                            </div>
                            <div class="col-3">
                                <button data-value="9" class="btn btn-dark btn-calc w-100 py-3 fs-4 fw-bold">9</button>
                            </div>
                            <div class="col-3">
                                <button data-value="*" class="btn btn-primary btn-calc w-100 py-3 fs-4 fw-bold">*</button>
                            </div>

                            <!-- Baris ketiga tombol: 4, 5, 6, - -->
                            <div class="col-3">
                                <button data-value="4" class="btn btn-dark btn-calc w-100 py-3 fs-4 fw-bold">4</button>
                            </div>
                            <div class="col-3">
                                <button data-value="5" class="btn btn-dark btn-calc w-100 py-3 fs-4 fw-bold">5</button>
                            </div>
                            <div class="col-3">
                                <button data-value="6" class="btn btn-dark btn-calc w-100 py-3 fs-4 fw-bold">6</button>
                            </div>
                            <div class="col-3">
                                <button data-value="-" class="btn btn-primary btn-calc w-100 py-3 fs-4 fw-bold">-</button>
                            </div>

                            <!-- Baris keempat tombol: 1, 2, 3, + -->
                            <div class="col-3">
                                <button data-value="1" class="btn btn-dark btn-calc w-100 py-3 fs-4 fw-bold">1</button>
                            </div>
                            <div class="col-3">
                                <button data-value="2" class="btn btn-dark btn-calc w-100 py-3 fs-4 fw-bold">2</button>
                            </div>
                            <div class="col-3">
                                <button data-value="3" class="btn btn-dark btn-calc w-100 py-3 fs-4 fw-bold">3</button>
                            </div>
                            <div class="col-3">
                                <button data-value="+" class="btn btn-primary btn-calc w-100 py-3 fs-4 fw-bold">+</button>
                            </div>

                            <!-- Baris kelima tombol: 0 (span 2 kolom), ., = -->
                            <div class="col-6">
                                <button data-value="0" class="btn btn-dark btn-calc w-100 py-3 fs-4 fw-bold">0</button>
                            </div>
                            <div class="col-3">
                                <button data-value="." class="btn btn-dark btn-calc w-100 py-3 fs-4 fw-bold">.</button>
                            </div>
                            <div class="col-3">
                                <button data-value="=" class="btn btn-success btn-calc w-100 py-3 fs-4 fw-bold">=</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Menjalankan kode JavaScript setelah DOM dimuat sepenuhnya
        document.addEventListener('DOMContentLoaded', function() {
            
            // Mengambil elemen display, gambar status, dan semua tombol kalkulator
            const display = document.getElementById('display');
            const statusImage = document.getElementById('statusImage');
            const buttons = document.querySelectorAll('.btn-calc');

            // URL gambar untuk status normal, sukses, dan error
            const imgNormal = 'https://placehold.co/400x100/CBC3E3/FFFFFF?text=Kalkulator';
            const imgSuccess = 'https://placehold.co/400x100/16A34A/FFFFFF?text=Sukses!';
            const imgError = 'https://placehold.co/400x100/DC2626/FFFFFF?text=Error!';

            /**
             * Fungsi untuk mengubah gambar status berdasarkan kondisi perhitungan
             */
            function changeImage(state) {
                if (state === 'success') {
                    statusImage.src = imgSuccess;
                    statusImage.alt = "Perhitungan Sukses";
                } else if (state === 'error') {
                    statusImage.src = imgError;
                    statusImage.alt = "Error Perhitungan";
                } else {
                    // Mengatur gambar ke status normal
                    statusImage.src = imgNormal;
                    statusImage.alt = "Status Kalkulator";
                }
            }

            /**
             * Fungsi untuk membersihkan display dan mengatur gambar ke normal
             */
            function clearDisplay() {
                display.value = '';
                changeImage('normal'); // Memanggil function untuk merubah gambar
            }

            /**
             * Fungsi untuk menghapus karakter terakhir dari display
             */
            function deleteLastChar() {
                display.value = display.value.slice(0, -1);
            }

            /**
             * Fungsi untuk menambahkan nilai ke display
             */
            function appendToDisplay(value) {
                display.value += value;
            }

            /**
             * Fungsi untuk menghitung hasil ekspresi matematika di display
             */
            function calculateResult() {
                // Mengecek apakah display kosong
                if (display.value === '') {
                    changeImage('error');
                    display.value = 'Kosong!';
                    // Mengatur timeout untuk membersihkan display setelah 1.5 detik
                    setTimeout(clearDisplay, 1500);
                    return;
                }

                try {
                    // Menggunakan eval untuk menghitung ekspresi, dengan mengganti % menjadi /100
                    let result = eval(display.value
                        .replace(/%/g, '/100') // Mengganti operator % dengan pembagian 100 untuk persentase
                    ); 
                    
                    // Mengecek apakah hasil adalah angka valid
                    if (isFinite(result)) {
                        display.value = result;
                        changeImage('success'); // Mengubah gambar ke sukses
                    } else {
                        throw new Error("Hasil tidak valid");
                    }

                } catch (error) {
                    console.error("Error kalkulasi:", error);
                    display.value = 'Error';
                    changeImage('error'); // Mengubah gambar ke error
                    setTimeout(clearDisplay, 1500);
                }
            }


            // Menambahkan event listener untuk setiap tombol kalkulator
            buttons.forEach(button => {
                button.addEventListener('click', () => {
                    const value = button.getAttribute('data-value');

                    // Menggunakan switch untuk menangani nilai tombol
                    switch(value) {
                        case 'C':
                            // Membersihkan display
                            clearDisplay();
                            break;
                        case 'DEL':
                            // Menghapus karakter terakhir
                            deleteLastChar();
                            break;
                        case '=':
                            // Menghitung hasil
                            calculateResult();
                            break;
                        default:
                            // Mengecek apakah gambar status adalah sukses atau error, jika ya maka bersihkan display terlebih dahulu
                            if (statusImage.src === imgSuccess || statusImage.src === imgError) {
                                clearDisplay();
                            }
                            appendToDisplay(value);
                            break;
                    }
                });
            });

            // Menambahkan event listener untuk keyboard input
            document.addEventListener('keydown', (e) => {
                const key = e.key;

                if (key >= '0' && key <= '9' || key === '.' || key === '+' || key === '-' || key === '*' || key === '/' || key === '%') {
                    if (statusImage.src === imgSuccess || statusImage.src === imgError) {
                        clearDisplay();
                    }
                    appendToDisplay(key);
                    e.preventDefault();
                } else if (key === 'Enter' || key === '=') {
                    calculateResult();
                    e.preventDefault();
                } else if (key === 'Backspace') {
                    deleteLastChar();
                    e.preventDefault();
                } else if (key === 'Escape' || key.toLowerCase() === 'c') {
                    clearDisplay();
                    e.preventDefault();
                }
            });

        });
    </script>
</body>
</html>
